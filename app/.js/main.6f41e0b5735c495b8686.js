(()=>{"use strict";var r=["+","-","*","/"];function o(r,o){o.innerHTML=r}var e="POWER(",t=[{symbol:"AC",formula:!1,type:"key"},{symbol:"←",formula:!1,type:"key"},{symbol:"%",formula:"/100",type:"number"},{symbol:"÷",formula:"/",type:"operator"},{symbol:"x",formula:"*",type:"operator"},{symbol:"-",formula:"-",type:"operator"},{symbol:"+",formula:"+",type:"operator"},{symbol:"=",formula:"=",type:"calculate"},{symbol:".",formula:".",type:"number"},{symbol:1,formula:1,type:"number"},{symbol:2,formula:2,type:"number"},{symbol:3,formula:3,type:"number"},{symbol:4,formula:4,type:"number"},{symbol:5,formula:5,type:"number"},{symbol:6,formula:6,type:"number"},{symbol:7,formula:7,type:"number"},{symbol:8,formula:8,type:"number"},{symbol:9,formula:9,type:"number"},{symbol:0,formula:0,type:"number"},{symbol:"(",formula:"(",type:"number"},{symbol:")",formula:")",type:"number"},{symbol:"mc",formula:!1,type:"save"},{symbol:"m+",formula:!1,type:"save"},{symbol:"m-",formula:!1,type:"save"},{symbol:"mr",formula:!1,type:"save"},{name:"powY",symbol:"xy",formula:e,type:"math_function"},{name:"pow2",symbol:"x2",formula:e,type:"math_function"},{name:"pow3",symbol:"x3",formula:e,type:"math_function"},{name:"10powX",symbol:"10powX",formula:e,type:"math_function"},{name:"exp",symbol:"ex",formula:"Math.exp(",type:"math_function"},{name:"1divX",symbol:"1divX",formula:"1/(",type:"math_function"},{name:"square-root",symbol:"√(",formula:"Math.sqrt(",type:"math_function"},{name:"qube-root",symbol:"(3)√(",formula:"Math.cbrt(",type:"math_function"},{name:"ln",symbol:"ln2",formula:!1,type:"math_function"},{name:"log10",symbol:"log10",formula:"Math.log(10)",type:"math_function"},{name:"x-root",symbol:"√(",formula:e,type:"math_function"}];function a(r,o){for(var e=[],t=0,a="",n=0;n<r.length;++n){var u=r[n];"("===u?t++:")"===u&&t--,0==t&&o===u?(e.push(a),a=""):a+=u}return""!=a&&e.push(a),e}function n(r){return a(r,"+").map((function(r){return function(r){var o=a(r,"-").map((function(r){return function(r){return a(r,"*").map((function(r){return Number.isNaN(+r)?function(r){return a(r.toString(),"/").map((function(r){return"("===r[0]?n(r.substr(1,r.length-2)):+r})).reduce((function(r,o,e){if(0!==e)return r/o}))}(r):+r})).reduce((function(r,o){return r*o}),1)}(r)})),e=o[0];return o.slice(1).reduce((function(r,o){return r-o}),e)}(r)})).reduce((function(r,o){return+r+ +o}),0)}function u(r,o){(null==o||o>r.length)&&(o=r.length);for(var e=0,t=new Array(o);e<o;e++)t[e]=r[e];return t}var m,l=document.querySelector(".button-panel"),f=document.querySelector(".operation-panel .value"),c=document.querySelector(".result .value"),s=document.querySelector(".theme"),i=0,p=!1,y=!1,b=new RegExp(/Math.pow\(([^)]+)\)/g),h={operation:[],formula:[]};s.classList.add("dark"),l.addEventListener("click",(function(e){var a=e.target.textContent;e.target.closest("button")&&t.forEach((function(t){(t.symbol==a||t.name==e.target.id)&&function(e){switch(e.type){case"operator":case"number":v(e.symbol,e.formula);break;case"key":"AC"===e.symbol?(h.operation=[],h.formula=[],o(0,c)):"←"===e.symbol&&(h.operation.pop(),h.formula.pop());break;case"save":!function(r){switch(r.symbol){case"m+":i+=parseInt(c.innerHTML,10);break;case"m-":i-=parseInt(c.innerHTML,10);break;case"mr":o(i,c);break;case"mc":i=0}}(e);break;case"math_function":!function(r){switch(r.name){case"powY":v("^(",r.formula),p=!0;break;case"pow2":v("^(",r.formula),v("2)","2)"),p=!0;break;case"pow3":v("^(",r.formula),v("3)","3)"),p=!0;break;case"10powX":v("10^(",r.formula),p=!0;break;case"exp":v("exp(",r.formula);break;case"1divX":case"square-root":case"qube-root":v(r.symbol,r.formula);break;case"ln":v(Math.LN2.toFixed(5),Math.LN2.toFixed(5));break;case"log10":v(Math.log(10),r.formula),h.operation.push(Math.log(10)),h.formula.push(r.formula);break;case"x-root":v(r.symbol,r.formula),p=!0,y=!0}}(e);break;case"calculate":m=h.formula.join(""),p&&(m=function(o,e,t,a){var n,u,m,l=(n=e.formula,u=t,m=[],n.forEach((function(r,o){r===u&&m.push(o)})),m),f=function(o,e,t){var a=[];return e.forEach((function(e){for(var t=[],n=0,u=e-1;u>=0;){"("===o[u]&&n--,")"===o[u]&&n++;var m=!1;r.forEach((function(r){o[u]===r&&(m=!0)}));var l=void 0===o[u];if(m&&0===n||l)break;t.unshift(o[u]),u--}a.push(t.join(""))})),a}(e.formula,l);if(a&&""===f[0])return e.formula.pop(),e.formula.shift(),e.formula.unshift("Math.sqrt("),e.formula.push(")"),o=e.formula.join(""),a=!1,o;if(a)f.forEach((function(r){var e=r+t,n="Math.pow("+r+",1/";o=o.replace(e,n),a=!1}));else if(""===f[0]){var c=t;o=o.replace(c,"Math.pow(10,")}else f.forEach((function(r){var e=r+t,a="Math.pow("+r+",";o=o.replace(e,a)}));return o}(m,h,"POWER(",y),p=!1),m=function(r,o){var e,t=function(r){if(Array.isArray(r))return u(r)}(e=r.matchAll(o))||function(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(e)||function(r,o){if(r){if("string"==typeof r)return u(r,o);var e=Object.prototype.toString.call(r).slice(8,-1);return"Object"===e&&r.constructor&&(e=r.constructor.name),"Map"===e||"Set"===e?Array.from(r):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?u(r,o):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),a=[];return t.forEach((function(r){var o=r[1].split(",");a.push(Math.pow(n(o[0]),n(o[1])))})),t.forEach((function(o,e){return r=r.replace(o[0],a[e].toString())})),r}(m,b);try{n(m)}catch(r){console.error(r)}return void(isNaN(n(m))?o("reference error",c):isFinite(n(m))?o(n(m),c):o("divide by zero",c))}!function(r,o){o.innerHTML=r}(h.operation.join(""),f)}(t)}))}));var v=function(r,o){h.operation.push(r),h.formula.push(o)}})();