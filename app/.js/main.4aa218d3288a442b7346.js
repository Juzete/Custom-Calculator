(()=>{"use strict";var o=["+","-","*","/"];function r(o,r){r.innerHTML=o}var e="POWER(",t=[{symbol:"AC",formula:!1,type:"key"},{symbol:"←",formula:!1,type:"key"},{symbol:"%",formula:"/100",type:"number"},{symbol:"÷",formula:"/",type:"operator"},{symbol:"x",formula:"*",type:"operator"},{symbol:"-",formula:"-",type:"operator"},{symbol:"+",formula:"+",type:"operator"},{symbol:"=",formula:"=",type:"calculate"},{symbol:".",formula:".",type:"number"},{symbol:1,formula:1,type:"number"},{symbol:2,formula:2,type:"number"},{symbol:3,formula:3,type:"number"},{symbol:4,formula:4,type:"number"},{symbol:5,formula:5,type:"number"},{symbol:6,formula:6,type:"number"},{symbol:7,formula:7,type:"number"},{symbol:8,formula:8,type:"number"},{symbol:9,formula:9,type:"number"},{symbol:0,formula:0,type:"number"},{symbol:"(",formula:"(",type:"number"},{symbol:")",formula:")",type:"number"},{symbol:"mc",formula:!1,type:"save"},{symbol:"m+",formula:!1,type:"save"},{symbol:"m-",formula:!1,type:"save"},{symbol:"mr",formula:!1,type:"save"},{name:"powY",symbol:"xy",formula:e,type:"math_function"},{name:"pow2",symbol:"x2",formula:e,type:"math_function"},{name:"pow3",symbol:"x3",formula:e,type:"math_function"},{name:"10powX",symbol:"10powX",formula:e,type:"math_function"},{name:"exp",symbol:"ex",formula:"Math.exp(",type:"math_function"},{name:"1divX",symbol:"1divX",formula:"1/(",type:"math_function"},{name:"square-root",symbol:"√(",formula:"Math.sqrt(",type:"math_function"},{name:"qube-root",symbol:"(3)√(",formula:"Math.cbrt(",type:"math_function"},{name:"ln",symbol:"ln2",formula:!1,type:"math_function"},{name:"log10",symbol:"log10",formula:"Math.log(10)",type:"math_function"},{name:"x-root",symbol:"√(",formula:e,type:"math_function"}];function a(o,r){for(var e=[],t=0,a="",n=0;n<o.length;++n){var u=o[n];"("==u?t++:")"==u&&t--,0==t&&r==u?(e.push(a),a=""):a+=u}return""!=a&&e.push(a),e}function n(o){return a(o,"+").map((function(o){return function(o){var r=a(o,"-").map((function(o){return function(o){return a(o,"*").map((function(o){return Number.isNaN(+o)?function(o){return a(o.toString(),"/").map((function(o){return"("==o[0]?n(o.substr(1,o.length-2)):+o})).reduce((function(o,r,e){if(0!=e)return o/r}))}(o):+o})).reduce((function(o,r){return o*r}),1)}(o)})),e=r[0];return r.slice(1).reduce((function(o,r){return o-r}),e)}(o)})).reduce((function(o,r){return+o+ +r}),0)}function u(o,r){(null==r||r>o.length)&&(r=o.length);for(var e=0,t=new Array(r);e<r;e++)t[e]=o[e];return t}var m,l,f,p=document.querySelector(".button-panel"),s=document.querySelector(".operation-panel .value"),i=document.querySelector(".result .value"),y=document.querySelectorAll(".theme"),c=0,b=!1,h=!1,v=new RegExp(/Math.pow\(([^)]+)\)/g),d={operation:[],formula:[]};function g(e){switch(e.type){case"operator":case"number":d.operation.push(e.symbol),d.formula.push(e.formula);break;case"key":"AC"==e.symbol?(d.operation=[],d.formula=[],r(0,i)):"←"==e.symbol&&(d.operation.pop(),d.formula.pop());break;case"save":"m+"==e.symbol?c+=parseInt(i.innerHTML,10):"m-"==e.symbol?c-=parseInt(i.innerHTML,10):"mr"==e.symbol?r(c,i):"mc"==e.symbol&&(c=0);break;case"math_function":"powY"==e.name?(l="^(",f=e.formula,d.operation.push(l),d.formula.push(f),b=!0):"pow2"==e.name?(l="^(",f=e.formula,d.operation.push(l),d.formula.push(f),d.operation.push("2)"),d.formula.push("2)"),b=!0):"pow3"==e.name?(l="^(",f=e.formula,d.operation.push(l),d.formula.push(f),d.operation.push("3)"),d.formula.push("3)"),b=!0):"10powX"==e.name?(l="10^(",f=e.formula,d.operation.push(l),d.formula.push(f),b=!0):"exp"==e.name?(l="exp(",f=e.formula,d.operation.push(l),d.formula.push(f)):"1divX"==e.name?(d.operation.push(e.formula),d.formula.push(e.formula)):"square-root"==e.name||"qube-root"==e.name?(d.operation.push(e.symbol),d.formula.push(e.formula)):"ln"==e.name?(d.operation.push(Math.LN2.toFixed(5)),d.formula.push(Math.LN2.toFixed(5))):"log10"==e.name?(d.operation.push(Math.log(10)),d.formula.push(e.formula)):"x-root"==e.name&&(d.operation.push(e.symbol),d.formula.push(e.formula),b=!0,h=!0);break;case"calculate":m=d.formula.join(""),b&&(m=function(r,e,t,a){var n,u,m,l=(n=e.formula,u=t,m=[],n.forEach((function(o,r){o==u&&m.push(r)})),m),f=function(r,e,t){var a=[];return e.forEach((function(e){for(var t=[],n=0,u=e-1;u>=0;){"("==r[u]&&n--,")"==r[u]&&n++;var m=!1;o.forEach((function(o){r[u]==o&&(m=!0)}));var l=null==r[u];if(m&&0==n||l)break;t.unshift(r[u]),u--}a.push(t.join(""))})),a}(e.formula,l);if(a&&""===f[0])return e.formula.pop(),e.formula.shift(),e.formula.unshift("Math.sqrt("),e.formula.push(")"),r=e.formula.join(""),a=!1,r;if(a)f.forEach((function(o){var e=o+t,n="Math.pow("+o+",1/";r=r.replace(e,n),a=!1}));else if(""===f[0]){var p=t;r=r.replace(p,"Math.pow(10,")}else f.forEach((function(o){var e=o+t,a="Math.pow("+o+",";r=r.replace(e,a)}));return r}(m,d,"POWER(",h),b=!1),m=function(o,r){var e,t=function(o){if(Array.isArray(o))return u(o)}(e=o.matchAll(r))||function(o){if("undefined"!=typeof Symbol&&null!=o[Symbol.iterator]||null!=o["@@iterator"])return Array.from(o)}(e)||function(o,r){if(o){if("string"==typeof o)return u(o,r);var e=Object.prototype.toString.call(o).slice(8,-1);return"Object"===e&&o.constructor&&(e=o.constructor.name),"Map"===e||"Set"===e?Array.from(o):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?u(o,r):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),a=[];return t.forEach((function(o){var r=o[1].split(",");a.push(Math.pow(n(r[0]),n(r[1])))})),t.forEach((function(r,e){return o=o.replace(r[0],a[e].toString())})),o}(m,v);try{n(m)}catch(o){console.error(o)}return void(isFinite(n(m))?isNaN(n(m))?r("reference error",i):r(n(m),i):r("divide by zero",i))}var t;t=d.operation.join(""),s.innerHTML=t}y.forEach((function(o){return o.classList.add("dark")})),p.addEventListener("click",(function(o){var r=o.target.textContent;o.target.closest("button")&&t.forEach((function(e){(e.symbol==r||e.name==o.target.id)&&g(e)}))}))})();